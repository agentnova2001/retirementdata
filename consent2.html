<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Consent2</title>

<style>
  * {
    box-sizing: border-box;
  }

  body {
    margin: 0;
    padding: 0;
    background: #f5f5f5;
    font-family: Arial, sans-serif;
  }

  /* ğŸ”´ Consent3ì™€ ë™ì¼ */
  .wrapper {
    width: 100%;
    max-width: 360px;
    margin: 0 auto;
    padding: 8px;
  }

  /* ğŸ”´ ë†’ì´ë¥¼ ì—¬ê¸°ì„œ ê³ ì • */
  .consent-box {
    display: flex;
    width: 100%;
    height: 180px; /* â† Consent3 ê¸°ì¤€ */
    border: 2px solid #000;
    background: #fff;
  }

  .panel {
    position: relative;
    flex: 1;
    overflow: hidden;
    border-right: 2px solid #000;
  }

  .panel:last-child {
    border-right: none;
  }

  .panel.agree {
    background: #cfefff;
  }

  .label-top {
    position: absolute;
    top: 4px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 10px;
    color: #000;
    z-index: 3;
    pointer-events: none;
  }

  canvas {
    position: absolute;
    inset: 0;
    z-index: 2;
  }

  .btn-area {
    margin-top: 8px;
    text-align: center;
  }

  button {
    padding: 8px 16px;
    font-size: 14px;
    font-weight: bold;
  }
</style>
</head>

<body>
<div class="wrapper">

  <div class="consent-box">
    <div class="panel agree">
      <div class="label-top">[ë™ì˜]</div>
      <canvas id="agreeCanvas2"></canvas>
    </div>

    <div class="panel">
      <div class="label-top">[ë¯¸ë™ì˜]</div>
      <canvas id="disagreeCanvas2"></canvas>
    </div>
  </div>

  <div class="btn-area">
    <button onclick="saveConsent2()">í™•ì¸</button>
  </div>

</div>

<script>
  function setupCanvas(canvas) {
    const panel = canvas.parentElement;
    const ctx = canvas.getContext("2d");

    canvas.width = panel.clientWidth;
    canvas.height = panel.clientHeight;

    ctx.lineWidth = 3;
    ctx.lineCap = "round";
    ctx.strokeStyle = "rgba(0,128,0,0.5)";

    let drawing = false;

    const getPos = e => {
      const rect = canvas.getBoundingClientRect();
      if (e.touches) {
        return {
          x: e.touches[0].clientX - rect.left,
          y: e.touches[0].clientY - rect.top
        };
      }
      return { x: e.offsetX, y: e.offsetY };
    };

    const start = e => {
      e.preventDefault();
      drawing = true;
      const p = getPos(e);
      ctx.beginPath();
      ctx.moveTo(p.x, p.y);
    };

    const move = e => {
      if (!drawing) return;
      e.preventDefault();
      const p = getPos(e);
      ctx.lineTo(p.x, p.y);
      ctx.stroke();
    };

    const end = () => drawing = false;

    canvas.addEventListener("mousedown", start);
    canvas.addEventListener("mousemove", move);
    canvas.addEventListener("mouseup", end);
    canvas.addEventListener("mouseleave", end);

    canvas.addEventListener("touchstart", start);
    canvas.addEventListener("touchmove", move);
    canvas.addEventListener("touchend", end);
  }

  const agreeCanvas2 = document.getElementById("agreeCanvas2");
  const disagreeCanvas2 = document.getElementById("disagreeCanvas2");

  setupCanvas(agreeCanvas2);
  setupCanvas(disagreeCanvas2);

  function saveConsent2() {
    const agreeImg = agreeCanvas2.toDataURL("image/png");
    const disagreeImg = disagreeCanvas2.toDataURL("image/png");

    const consent2Flag =
      agreeImg.length > disagreeImg.length ? "Y" : "N";

    window.parent.postMessage({
      consent2_agree_image: agreeImg,
      consent2_disagree_image: disagreeImg,
      consent2_flag: consent2Flag
    }, "*");
  }
</script>
</body>
</html>