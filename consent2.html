<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Consent2</title>

<style>
  body {
    margin: 0;
    padding: 0;
    background: #f5f5f5;
    font-family: Arial, sans-serif;
  }

  .wrapper {
    width: 100%;
    max-width: 420px;
    margin: 0 auto;
    padding: 10px;
  }

  .consent-box {
    display: flex;
    border: 2px solid #000;
    height: 220px; /* ğŸ”´ Consent3ì™€ ë™ì¼ */
    background: #fff;
  }

  .panel {
    position: relative;
    flex: 1;
    border-right: 2px solid #000;
    overflow: hidden;
  }

  .panel:last-child {
    border-right: none;
  }

  .panel.agree {
    background: #cfefff; /* í•˜ëŠ˜ìƒ‰ */
  }

  .label-top {
    position: absolute;
    top: 4px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 10px;
    font-weight: normal;
    color: #000;
    z-index: 3;
  }

  canvas {
    position: absolute;
    top: 0;
    left: 0;
    z-index: 2;
  }

  .btn-area {
    margin-top: 10px;
    text-align: center;
  }

  button {
    padding: 10px 18px;
    font-size: 14px;
    font-weight: bold;
    cursor: pointer;
  }
</style>
</head>

<body>
<div class="wrapper">

  <div class="consent-box">
    <!-- ë™ì˜ -->
    <div class="panel agree">
      <div class="label-top">[ë™ì˜]</div>
      <canvas id="canvasAgree2"></canvas>
    </div>

    <!-- ë¯¸ë™ì˜ -->
    <div class="panel">
      <div class="label-top">[ë¯¸ë™ì˜]</div>
      <canvas id="canvasDisagree2"></canvas>
    </div>
  </div>

  <div class="btn-area">
    <button onclick="saveConsent2()">í™•ì¸</button>
  </div>

</div>

<script>
  const agreeCanvas = document.getElementById("canvasAgree2");
  const disagreeCanvas = document.getElementById("canvasDisagree2");

  const canvases = [agreeCanvas, disagreeCanvas];

  canvases.forEach(canvas => {
    canvas.width = canvas.parentElement.clientWidth;
    canvas.height = canvas.parentElement.clientHeight;

    const ctx = canvas.getContext("2d");
    ctx.lineWidth = 3;
    ctx.lineCap = "round";
    ctx.strokeStyle = "rgba(0, 128, 0, 0.5)"; // ì´ˆë¡ìƒ‰ + 50% íˆ¬ëª…ë„

    let drawing = false;

    const start = e => {
      drawing = true;
      ctx.beginPath();
      ctx.moveTo(e.offsetX, e.offsetY);
    };

    const move = e => {
      if (!drawing) return;
      ctx.lineTo(e.offsetX, e.offsetY);
      ctx.stroke();
    };

    const end = () => {
      drawing = false;
    };

    canvas.addEventListener("mousedown", start);
    canvas.addEventListener("mousemove", move);
    canvas.addEventListener("mouseup", end);
    canvas.addEventListener("mouseleave", end);

    canvas.addEventListener("touchstart", e => {
      e.preventDefault();
      const t = e.touches[0];
      const rect = canvas.getBoundingClientRect();
      ctx.beginPath();
      ctx.moveTo(t.clientX - rect.left, t.clientY - rect.top);
      drawing = true;
    });

    canvas.addEventListener("touchmove", e => {
      e.preventDefault();
      if (!drawing) return;
      const t = e.touches[0];
      const rect = canvas.getBoundingClientRect();
      ctx.lineTo(t.clientX - rect.left, t.clientY - rect.top);
      ctx.stroke();
    });

    canvas.addEventListener("touchend", () => drawing = false);
  });

  function saveConsent2() {
    const agreeData = agreeCanvas.toDataURL("image/png");
    const disagreeData = disagreeCanvas.toDataURL("image/png");

    const isAgreed2 = agreeData.length > disagreeData.length ? "Y" : "N";

    /* ğŸ”½ Typebot ì „ë‹¬ìš© */
    window.parent.postMessage({
      consent2_agree_image: agreeData,
      consent2_disagree_image: disagreeData,
      consent2_flag: isAgreed2
    }, "*");
  }
</script>
</body>
</html>